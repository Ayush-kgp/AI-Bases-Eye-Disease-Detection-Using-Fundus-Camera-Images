# Fundus Disease Detection System

A deep learning-based system for detecting various retinal conditions from fundus images. This project uses EfficientNet-B0 architecture to classify fundus images into 39 different conditions, including normal cases and various retinal diseases.

## Features

- **Real-time Disease Detection**: Upload fundus images and get instant predictions
- **Attention Map Visualization**: See which regions of the image influenced the model's decision (via Grad-CAM)
- **User-friendly Interface**: Clean and intuitive Streamlit-based web interface with dedicated buttons for prediction and attention map
- **Comprehensive Analysis**: Supports 39 different retinal conditions
- **Detailed Explanations**: Includes information about predictions and visualizations
- **Medical Disclaimer**: Clearly states that results are for informational purposes only

## Project Structure

```
fundus-analysis/
├── backend/
│   ├── models/
│   │   ├── efficientnet_best.pth
│   │   └── mobilenet.pth
│   ├── app/
│   │   ├── api/
│   │   │   └── endpoints.py
│   │   ├── models/
│   │   │   └── predictor.py
│   │   └── main.py
│   └── requirements.txt
├── frontend/
│   ├── app.py
│   └── requirements.txt
└── README.md
```

## Installation

1. **Clone the repository and set up a virtual environment**

```bash
# Clone the repository
git clone [repository-url]
cd [repository-name]

# Create and activate a virtual environment
python -m venv venv
# On Windows:
venv\Scripts\activate
# On Linux/Mac:
source venv/bin/activate
```

2. **Install backend dependencies:**
```bash
cd backend
pip install -r requirements.txt
```

3. **Install frontend dependencies:**
```bash
cd ../frontend
pip install -r requirements.txt
```

4. **Model Weights:**
   - Place `efficientnet_best.pth` (and any other models) in `backend/models/`.

## Usage

1. **Start the backend:**
   ```bash
   cd backend
   uvicorn app.main:app --reload
   ```

2. **Start the frontend:**
   ```bash
   cd ../frontend
   streamlit run app.py
   ```

3. **Open your browser:**
   - Frontend: http://localhost:8501
   - Backend API: http://localhost:8000

## How to Use

- Upload a fundus image.
- Click **Predict Disease** to get the AI's prediction.
- Click **Show Attention Map** to see which regions influenced the model's decision.

### Disclaimer

> **This prediction is generated by an AI model and is intended for informational purposes only. It is not a substitute for professional medical advice, diagnosis, or treatment. Always consult a qualified healthcare provider with any questions you may have regarding a medical condition.**

### About the Attention Map

> **The attention map (also known as Grad-CAM) highlights the regions of the fundus image that most influenced the AI model's prediction. Brighter or more colored areas indicate regions that were more important for the model's decision. This visualization can help provide insight into what the model is focusing on, but it should not be interpreted as a clinical explanation.**

## Supported Conditions

The system can detect various retinal conditions, including:
- Normal and tessellated fundus
- Diabetic Retinopathy (DR1, DR2, DR3)
- Glaucoma and optic nerve conditions
- Macular conditions (ERM, MH)
- Retinal vein occlusions (BRVO, CRVO)
- And many more...

## System Architecture

The project consists of two main components:

1. **FastAPI Backend** (`app/main.py`):
   - Handles image processing and model inference
   - Implements Grad-CAM visualization
   - Provides REST API endpoints for predictions

2. **Streamlit Frontend** (`frontend/app.py`):
   - User-friendly web interface
   - Image upload and display
   - Results visualization
   - Educational content about fundus images

## API Endpoints

- `POST /api/v1/predict`: Get disease prediction for an uploaded image
- `POST /api/v1/predict-with-gradcam`: Get Grad-CAM (attention map) visualization for an uploaded image
- `GET /`: Check if the server is running

## Model Details

- Architecture: EfficientNet-B0
- Input size: 224x224 pixels
- Number of classes: 39
- Preprocessing: CLAHE enhancement, normalization

## Dependencies

Key dependencies include:
- PyTorch
- FastAPI
- Streamlit
- OpenCV
- Grad-CAM
- Other requirements listed in `requirements.txt`

## Important Notes

- This is a screening tool and should not be used as a replacement for professional medical diagnosis
- Always consult healthcare professionals for proper diagnosis and treatment
- The model's predictions should be used as a supplementary tool for healthcare providers
